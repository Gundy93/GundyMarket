# ê±´ë””ë§ˆì¼“

ì‹¤ì œ ì„œë²„ì™€ REST API í†µì‹ ì„ í•˜ëŠ” ë¬¼ê±´ ê±°ë˜ ì•±ìœ¼ë¡œ, [iOS ì˜¤í”ˆë§ˆì¼“](https://github.com/Gundy93/ios-open-market)ì˜ ë¦¬íŒ©í† ë§ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

## ğŸ“š ëª©ì°¨

- [ğŸ”‘ **í‚¤ì›Œë“œ**](#-í‚¤ì›Œë“œ)
- [ğŸ—ï¸ **ì•± êµ¬ì¡°**](#-ì•±-êµ¬ì¡°)
- [ğŸ“± **ì‹¤í–‰ í™”ë©´**](#-ì‹¤í–‰-í™”ë©´)
- [â¤ï¸â€ğŸ©¹ **íŠ¸ëŸ¬ë¸” ìŠˆíŒ…**](#-íŠ¸ëŸ¬ë¸”-ìŠˆíŒ…)
- [ğŸ’­ **ì´ìœ  ìˆëŠ” ì½”ë“œ**](#-ì´ìœ -ìˆëŠ”-ì½”ë“œ)

## ğŸ”‘ í‚¤ì›Œë“œ

- **P**rotocol **O**riented **P**rogramming
- **MVVM**
- **Clean Architecture**
- **Network**
- **Cache**
- **Unit Test**

[â¬†ï¸ ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°](#-ëª©ì°¨)

## ğŸ—ï¸ ì•± êµ¬ì¡°

### ê°œë°œë°©ë²•ë¡ : Protocol Oriented Programming

í”„ë¡œí† ì½œê³¼ ê°’ íƒ€ì…ì„ ì‚¬ìš©í•´ í”„ë¡œí† ì½œ ì§€í–¥ìœ¼ë¡œ ê°œë°œì„ í•˜ë©´ í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•œ ê°ì²´ ì§€í–¥ë³´ë‹¤ ì—¬ëŸ¬ ì„±ëŠ¥ì ì¸ ì´ì ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ í”„ë¡œì íŠ¸ì—ì„œëŠ” ì• í”Œì—ì„œ ì ê·¹ ê¶Œì¥í•˜ëŠ” POPë¥¼ í† ëŒ€ë¡œ ê°œë°œì„ ì§„í–‰í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ëŠ” ê°’ íƒ€ì…ì„ ì‚¬ìš©í•  ë¿ì´ê³ , íƒ€ì…ì˜ êµ¬í˜„ì€ SOLID ë“±ì˜ ê¸°ë³¸ì ì¸ ê°ì²´ì§€í–¥ ì›ì¹™ì„ ì§€í‚¤ëŠ” ë°©í–¥ìœ¼ë¡œ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.

### ì•„í‚¤í…ì³: MVVM

![MVVM](https://github.com/Gundy93/GundyMarket/assets/106914201/0875ec71-4084-4f9b-bcdb-f355e0728ba4)

Cocoa MVCë³´ë‹¤ í…ŒìŠ¤í„°ë¸”í•œ ì½”ë“œë¥¼ ë§Œë“¤ê³ ì í–ˆê¸° ë•Œë¬¸ì— ë·°ì™€ ë¡œì§ì„ ì™„ì „íˆ ë¶„ë¦¬ì‹œí‚¬ ìˆ˜ ìˆëŠ” MVVMì„ ì„ íƒí•˜ì˜€ìŠµë‹ˆë‹¤. ì´ í”„ë¡œì íŠ¸ì—ì„œ ViewControllerëŠ” ë·°ë¡œ ê°„ì£¼í•©ë‹ˆë‹¤.

### Clean Architecture

![CleanArchitecture](https://github.com/Gundy93/GundyMarket/assets/106914201/5ad8bd83-bd25-4aa6-8e48-60ddfb02a1e1)

ë ˆì´ì–´ë¥¼ ë‚˜ëˆ„ê³  ì˜ì¡´ì„± ë°©í–¥ì˜ ê·œì¹™ì„ ì§€í‚¤ëŠ” ì„ ì—ì„œ Clean Architectureë¥¼ ì ìš©í•˜ë©´ í…ŒìŠ¤í„°ë¸”í•¨ì€ ë¬¼ë¡ ì´ê³  OCP ë“±ì˜ ê°ì²´ ì§€í–¥ ì›ì¹™ë“¤ì„ ë”ìš± ì˜ ì¤€ìˆ˜í•  ìˆ˜ ìˆìœ¼ë¦¬ë¼ ìƒê°í•´ ì ìš©í•˜ê¸°ë¡œ í•˜ì˜€ìŠµë‹ˆë‹¤.

### Network

![NetwrokManager](https://github.com/Gundy93/GundyMarket/assets/106914201/b85f3e5a-ac29-4b46-ac3d-ce596fa2342d)

ë„¤íŠ¸ì›Œí¬ ë ˆì´ì–´ì—ì„œ ì™¸ë¶€ì˜ ë ˆì´ì–´ì™€ ì†Œí†µí•˜ëŠ” ê²ƒì€ NetworkManager ê°ì²´ì…ë‹ˆë‹¤. ì´ NetworkManagerëŠ” íŠ¹ì • íƒ€ì…ì— ëŒ€í•´ ì˜ì¡´í•˜ì§€ ì•Šë„ë¡ ì˜ì¡´ì„±ì„ í”„ë¡œí† ì½œë¡œ ì¶”ìƒí™”ì‹œì¼œ ê°ì¢… ê°ì²´ ì§€í–¥ ì›ì¹™ì„ ì§€í‚¤ë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.

### Cache

![Cache](https://github.com/Gundy93/GundyMarket/assets/106914201/ba0cecd0-72ca-4b2b-99c7-56e39a71587c)

ë„¤íŠ¸ì›Œí¬ ë ˆì´ì–´ì™€ ë§ˆì°¬ê°€ì§€ë¡œ íŠ¹ì • íƒ€ì…ì— ì˜ì¡´í•˜ì§€ ì•Šë„ë¡ í”„ë¡œí† ì½œì„ í™œìš©í•˜ì˜€ìŠµë‹ˆë‹¤. `Cache`ëŠ” `CacheProtocol`ì„ ì±„íƒí•©ë‹ˆë‹¤.

![ImageDataCacheManager](https://github.com/Gundy93/GundyMarket/assets/106914201/7bddd9a4-6ef5-4c3f-a4cb-de5c869707cb)

ì´ë¯¸ì§€ì— ëŒ€í•´ì„œëŠ” On-diskì™€ In-memory ë°©ì‹ìœ¼ë¡œ ìºì‹±í•  ìˆ˜ ìˆë„ë¡ `ImageDataCacheManager`ë¥¼ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤. ìºì‹œì— ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•Šì„ ê²½ìš° ì„¸ì…˜ì„ í†µí•´ ì´ë¯¸ì§€ë¥¼ ë°›ì•„ì˜¤ê³  ìºì‹œì— ì €ì¥í•˜ëŠ” ê³¼ì •ê¹Œì§€ `ImageDataCacheManager`ê°€ ë‹´ë‹¹í•©ë‹ˆë‹¤. ì´ë²ˆ í”„ë¡œì íŠ¸ì—ì„œëŠ” memory ìºì‹œì˜ `CacheStorage`ëŠ” `NSCache`ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.
í•˜ì§€ë§Œ disk ìºì‹œëŠ” ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë°, í˜„ì¬ í”„ë¡œì íŠ¸ì˜ íŠ¹ì„±ìƒ ë””ìŠ¤í¬ë¡œ ìºì‹œí•  í•„ìš”ê°€ ì—†ë‹¤ê³  ëŠê¼ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ìºì‹œë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•´ ë¶ˆí•„ìš”í•œ ë¹„ìš©ì´ ë°œìƒí•œë‹¤ê³  ì—¬ê²¨ ì´ë²ˆì—ëŠ” ë©”ëª¨ë¦¬ ìºì‹œë§Œ ì‚¬ìš©í•˜ê¸°ë¡œ ê²°ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

### Unit Test

POP, ê·¸ë¦¬ê³  MVVMì—ì„œ ì–»ì„ ìˆ˜ ìˆëŠ” ì¥ì ìœ¼ë¡œëŠ” ì—­ì‹œ testabilityë¥¼ ê¼½ê³  ì‹¶ìŠµë‹ˆë‹¤. ì´ë²ˆ í”„ë¡œì íŠ¸ì˜ ì•„í‚¤í…ì²˜ ì„ ì • ì‚¬ìœ ì¤‘ ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„ì´ í…ŒìŠ¤í„°ë¸”í•¨ì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. í…ŒìŠ¤íŠ¸ëŠ” ì‹¤ì œë¡œ ì¸í„°ë„· ì—°ê²°ì´ ë˜ì§€ ì•Šì€ ìƒí™©ì—ì„œë„ ê°€ëŠ¥í•´ì•¼ í•˜ë¯€ë¡œ ë„¤íŠ¸ì›Œí¬ì— ëŒ€í•´ì„œëŠ” í…ŒìŠ¤íŠ¸ ë”ë¸”ì„ í™œìš©í•˜ì˜€ìŠµë‹ˆë‹¤.

[â¬†ï¸ ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°](#-ëª©ì°¨)

## ğŸ“± ì‹¤í–‰ í™”ë©´

### ê¸°ëŠ¥ ê´€ë ¨

|ì´ë¯¸ì§€ ìºì‹±|||
|:-:|:-:|:-:|
||||

### UI ê´€ë ¨

|ê¸€ì“°ê¸° ë²„íŠ¼ í´ë¦­ì‹œ ìƒ‰ìƒ ë³€í™˜|||
|:-:|:-:|:-:|
||||

[â¬†ï¸ ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°](#-ëª©ì°¨)

## â¤ï¸â€ğŸ©¹ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…

### DecodingError.typeMismatch

ë„¤íŠ¸ì›Œí¬ ë ˆì´ì–´ ì„¤ê³„ë¥¼ ë§ˆì¹œ ê¹€ì— ìƒí’ˆ ëª©ë¡ì„ ë°›ì•„ì˜¤ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤. ì˜ˆìƒê³¼ëŠ” ë‹¤ë¥´ê²Œ ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ê°€ ë°˜í™˜ë˜ì—ˆìŠµë‹ˆë‹¤.

![image](https://github.com/Gundy93/GundyMarket/assets/106914201/e6c5e97a-7e64-4ee1-b745-3a7cbaa5b05b)

ì—ëŸ¬ë¥¼ ë°˜í™˜í•˜ëŠ” ì—¬ëŸ¬ ì§€ì ì— ë¸Œë ˆì´í¬ í¬ì¸íŠ¸ë¥¼ ë§Œë“¤ì–´ì„œ í™•ì¸í•œ ê²°ê³¼ `JSONDecoder`ì˜ `decode` ë©”ì„œë“œê°€ ì—ëŸ¬ë¥¼ ë°˜í™˜í•˜ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤.

LLDBë¥¼ í†µí•´ ì •í™•í•œ ì—ëŸ¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

![image](https://github.com/Gundy93/GundyMarket/assets/106914201/ed2ffdaf-be07-42ef-ba6c-60b46b996b2d)

`created_at`ì— í•´ë‹¹í•˜ëŠ” ê°’ì´ ì˜ëª» ë“¤ì–´ì˜¤ëŠ”ê°€ ì‹¶ì–´ ì •í™•íˆ ë°ì´í„°ê°€ ì–´ë–»ê²Œ ë“¤ì–´ì˜¤ëŠ”ì§€ë„ í™•ì¸í•´ë³´ì•˜ìŠµë‹ˆë‹¤. ì•Œê³ ë³´ë‹ˆ API ì•ˆë‚´ í˜ì´ì§€ì— ëª…ì‹œëœ `Date` íƒ€ì…ì˜ ê°’ì´ ì•„ë‹Œ `String` ê°’ì´ ë“¤ì–´ì˜¤ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤.

![image](https://github.com/Gundy93/GundyMarket/assets/106914201/eafc879a-7825-4f37-8911-abd1eab4029b)

|ê¸°ì¡´|ìˆ˜ì •|
|:--:|:--:|
|![image](https://github.com/Gundy93/GundyMarket/assets/106914201/cc0d45d0-c90d-4e74-953d-59c0e682c068)|![image](https://github.com/Gundy93/GundyMarket/assets/106914201/0932d742-b8cf-4ac1-b9b6-4d726e516508)|

í•´ë‹¹ í”„ë¡œí¼í‹°ë“¤ì„ `String` íƒ€ì…ìœ¼ë¡œ ë³€ê²½í•˜ëŠ” ê²ƒìœ¼ë¡œ ë¬¸ì œê°€ í•´ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.

ì´ë¡œ ì¸í•´ ë‹¨ìˆœíˆ JSON ë°ì´í„°ë¥¼ ë””ì½”ë”©í•˜ê¸° ìœ„í•œ ê°ì²´ë„ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ” ê²ƒì´ ì˜³ë‹¤ê³  ìƒê°í•˜ê²Œ ë¼, ë°”ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

### Date ê´€ë ¨ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨

ë‚ ì§œë¥¼ í‘œí˜„í•˜ëŠ” `String` ê°’ê³¼ `Date`ë¥¼ ë¹„êµí•˜ì—¬ `TimeInterval`ì„ ë°˜í™˜í•˜ëŠ” ë©”ì„œë“œë¥¼ í…ŒìŠ¤íŠ¸í•˜ì˜€ìŠµë‹ˆë‹¤. 2001ë…„ 1ì›” 1ì¼ì„ ì˜ë¯¸í•˜ëŠ” `ReferenceDate`ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•˜ì—¬ `"2001-01-02T00:00:00"`ë¥¼ ë¹„êµí•˜ë©´ ë”± í•˜ë£¨ ì°¨ì´ê°€ ë‚˜ê¸° ë•Œë¬¸ì— í•˜ë£¨ë¥¼ ì´ˆë‹¨ìœ„ë¡œ í™˜ì‚°í•œ `86400.0`ì´ ë°˜í™˜ë  ê²ƒì´ë¼ ì˜ˆìƒí–ˆìŠµë‹ˆë‹¤.

![image](https://github.com/Gundy93/GundyMarket/assets/106914201/287023df-e7e8-46f4-993e-bb262e7d2826)

í•˜ì§€ë§Œ í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë°˜í™˜ë˜ëŠ” ê°’ì€ `86400.0`ì´ ì•„ë‹Œ `54,000.0`ì´ì—ˆìŠµë‹ˆë‹¤. `Date(timeIntervalSinceReferenceDate:)`ì— ê°’ì„ ì „ë‹¬í•˜ë©´ì„œ 'UTC'ë¼ëŠ” ë‹¨ì–´ë¥¼ ë³¸ ê¸°ì–µì´ ë‚˜ ë‹¤ì‹œ ë¬¸ì„œë¥¼ í™•ì¸í–ˆìŠµë‹ˆë‹¤.

![image](https://github.com/Gundy93/GundyMarket/assets/106914201/337c7185-ae35-48d8-8391-fa265d027324)

2001ë…„ 1ì›” 1ì¼ì¸ ê²ƒì€ ë§ì§€ë§Œ, UTCê°€ ê¸°ì¤€ì´ì—ˆìŠµë‹ˆë‹¤.

![image](https://github.com/Gundy93/GundyMarket/assets/106914201/9f25a98d-48fe-4112-860c-a8a6eb8bb8fd)

í•˜ì§€ë§Œ `DateFormatter`ì˜ ì¸ìŠ¤í„´ìŠ¤ëŠ” `timeZone` í”„ë¡œí¼í‹°ë¥¼ ë”°ë¡œ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ì‹œìŠ¤í…œ ì‹œê°„ëŒ€ê°€ ì ìš©ë˜ë¯€ë¡œ ì´ëŸ¬í•œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤.

```swift
formatter.timeZone = TimeZone(abbreviation: "UTC")
```

![image](https://github.com/Gundy93/GundyMarket/assets/106914201/ba4ccd8e-17b1-4ed5-ac57-e48e051ffbb6)

`DateFormatter` ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì„¤ì •í•  ë•Œ `timeZone` í”„ë¡œí¼í‹°ë„ ê°™ì´ ì„¤ì •í•˜ì—¬ ë¬¸ì œë¥¼ í•´ê²°í•˜ì˜€ìŠµë‹ˆë‹¤.

### ì…€ì˜ ë†’ì´ê°€ 44ë¡œ ê³ ì •ë˜ëŠ” í˜„ìƒ

ë¦¬ìŠ¤íŠ¸ í˜•íƒœì˜ ë ˆì´ì•„ì›ƒì„ ì‚¬ìš©í•˜ê³ , ì…€ê°„ì˜ `separator`ì˜ í¬ê¸°ë¥¼ ì¡°ì ˆí•˜ê¸° ìœ„í•´ `UICollectionViewListCell`ì„ ìƒì†í•˜ëŠ” ì»¤ìŠ¤í…€ ì…€ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ì´ ì…€ì—ì„œ ì´ë¯¸ì§€ê°€ í¬í•¨ëœ ìŠ¤íƒë·°ì˜ `topAnchor`ì™€ `bottomAnchor`ë¥¼ `contentView`ì— ëŒ€í•´ ì˜¤í† ë ˆì´ì•„ì›ƒ ì œì•½ ì¡°ê±´ì„ ì„¤ì •í•˜ê³ , ì´ë¯¸ì§€ì˜ ë†’ì´ì™€ ë„ˆë¹„ë¥¼ 120ìœ¼ë¡œ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤. ê·¸ëŸ°ë° ë‹¤ìŒê³¼ ê°™ì€ ì˜¤í† ë ˆì´ì•„ì›ƒ ì œì•½ ì¡°ê±´ ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

```
Unable to simultaneously satisfy constraints.
	Probably at least one of the constraints in the following list is one you don't want. 
	Try this: 
		(1) look at each constraint and try to figure out which you don't expect; 
		(2) find the code that added the unwanted constraint or constraints and fix it. 
(
    "<NSLayoutConstraint:0x600002134ff0 V:|-(16)-[UIStackView:0x106414d30]   (active, names: '|':_UICollectionViewListCellContentView:0x10642e6f0 )>",
    "<NSLayoutConstraint:0x600002134d20 UIStackView:0x106414d30.bottom == _UICollectionViewListCellContentView:0x10642e6f0.bottom - 16   (active)>",
    "<NSLayoutConstraint:0x600002134f50 UIImageView:0x10642d200.width == 120   (active)>",
    "<NSLayoutConstraint:0x600002134050 UIImageView:0x10642d200.height == UIImageView:0x10642d200.width   (active)>",
    "<NSLayoutConstraint:0x6000021355e0 'UICollectionViewListCell-bottom-contentView-constraint' V:[_UICollectionViewListCellContentView:0x10642e6f0]-(0)-|   (active, names: '|':GundyMarket.ProductListCell:0x106417710 )>",
    "<NSLayoutConstraint:0x600002135540 'UICollectionViewListCell-top-contentView-constraint' V:|-(0)-[_UICollectionViewListCellContentView:0x10642e6f0]   (active, names: '|':GundyMarket.ProductListCell:0x106417710 )>",
    "<NSLayoutConstraint:0x6000021363a0 'UISV-canvas-connection' UIStackView:0x106414d30.top == UIImageView:0x10642d200.top   (active)>",
    "<NSLayoutConstraint:0x600002136620 'UISV-canvas-connection' V:[_UILayoutSpacer:0x600003d01b30'UISV-alignment-spanner']-(0)-|   (active, names: '|':UIStackView:0x106414d30 )>",
    "<NSLayoutConstraint:0x6000021364e0 'UISV-spanning-boundary' _UILayoutSpacer:0x600003d01b30'UISV-alignment-spanner'.bottom >= UIImageView:0x10642d200.bottom   (active)>",
    "<NSLayoutConstraint:0x600002136990 'UIView-Encapsulated-Layout-Height' GundyMarket.ProductListCell:0x106417710.height == 44   (active)>"
)

Will attempt to recover by breaking constraint 
<NSLayoutConstraint:0x600002134050 UIImageView:0x10642d200.height == UIImageView:0x10642d200.width   (active)>

Make a symbolic breakpoint at UIViewAlertForUnsatisfiableConstraints to catch this in the debugger.
The methods in the UIConstraintBasedLayoutDebugging category on UIView listed in <UIKitCore/UIView.h> may also be helpful.
```

`UICollectionViewListCell`ì˜ `height`ëŠ” 44ë¡œ ê³ ì •ë˜ëŠ” ì œì•½ ì¡°ê±´ì´ ë‚´ë¶€ì ìœ¼ë¡œ ê±¸ë ¤ìˆë˜ ê²ƒì…ë‹ˆë‹¤.

ê°™ì€ ìš°ì„ ë„ë¥¼ ê°€ì§„ ì¡°ê±´ì´ ì¶©ëŒí•´ ë°œìƒí•œ ê²ƒìœ¼ë¡œ, í•´ë‹¹ ì œì•½ ì¡°ê±´ì€ `required`ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²ƒìœ¼ë¡œ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤.

ëª‡ ê°€ì§€ í™•ì¸ ì ˆì°¨ë¥¼ ê±°ì³¤ìŠµë‹ˆë‹¤.

1. `UICollectionViewListCell`ì˜ ë¬¸ì œì¸ê°€?

    í•´ë‹¹ ì…€ì´ ìƒì†í•˜ëŠ” íƒ€ì…ì„ `UICollectionViewCell`ë¡œ ë³€ê²½í•´ë„ ê°™ì€ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

2. `UICollectionLayoutListConfiguration`ì™€ `UICollectionViewCompositionalLayout.list`ì˜ ë¬¸ì œì¸ê°€?

    ì»¬ë ‰ì…˜ë·°ì˜ ë ˆì´ì•„ì›ƒì„ í†µìƒì ì¸ `UICollectionViewCompositionalLayout`ìœ¼ë¡œ ë³€ê²½í•˜ë‹ˆ í•´ë‹¹ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì¦‰, ë ˆì´ì•„ì›ƒì—ì„œ ë°œìƒí•˜ëŠ” ì œì•½ì¸ ê²ƒìœ¼ë¡œ í™•ì¸í–ˆìŠµë‹ˆë‹¤.

ë¬¸ì œë¥¼ ì •í™•íˆ íŒŒì•…í•˜ê³  ë‚˜ì„œ ë ˆì´ì•„ì›ƒì„ êµì²´í• ì§€ ê³ ë¯¼ì„ í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ë ˆì´ì•„ì›ƒì„ êµì²´í•˜ëŠ” ëŒ€ì‹  ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ìœ¼ë¡œ ë¬¸ì œë¥¼ í•´ê²°í–ˆìŠµë‹ˆë‹¤.

```swift
let ratioConstraint = thumbnailImageView.heightAnchor.constraint(equalTo: thumbnailImageView.widthAnchor)
        
ratioConstraint.priority = .defaultHigh
ratioConstraint.isActive = true
```

ì œì•½ ìš°ì„ ìˆœìœ„ë¥¼ `defaultHigh`ë¡œ ë‚®ì¶° ì œì•½ ì¡°ê±´ì´ ì¶©ëŒë˜ì§€ ì•Šìœ¼ë©´ì„œë„ ì…€ ì‚¬ì´ì¦ˆë¥¼ ìœ ì§€í•  ìˆ˜ ìˆê²Œ í•˜ì˜€ìŠµë‹ˆë‹¤.

ì´ ë°©ë²•ì„ ì„ íƒí•œ ì´ìœ ëŠ” ë¦¬ìŠ¤íŠ¸ë¥¼ êµ¬ì„±í•˜ëŠ” ë° ìˆì–´ì„œ `UICollectionViewCompositionalLayout.list`ë¥¼ ì‚¬ìš©í•˜ëŠ” í¸ì´ í›¨ì”¬ ì½”ë“œê°€ ê°„ë‹¨ ëª…ë£Œí•˜ë‹¤. ì¦‰, í•´ë‹¹ ê¸°ëŠ¥ì„ ì•„ëŠ” ì‚¬ëŒì´ ë³¸ë‹¤ë©´ ë°”ë¡œ ì´í•´í•  ìˆ˜ ìˆì„ ì •ë„ë¡œ ê°€ë…ì„±ì´ ì¢‹ì•„ì§„ë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. ë˜í•œ ìœ ì§€ë³´ìˆ˜ ì¸¡ë©´ì— ìˆì–´ì„œë„ íœ´ë¨¼ ì—ëŸ¬ê°€ ë°œìƒí•  ì—¬ì§€ê°€ ë” ì ì€ ë¦¬ìŠ¤íŠ¸ ë ˆì´ì•„ì›ƒì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤.

### ì •í™•í•œ ì‹œê°ì„ ê¸°ë¡í•˜ì§€ ì•ŠëŠ” ì„œë²„

![image](https://github.com/Gundy93/GundyMarket/assets/106914201/bdebc54e-1717-4b9c-84a1-1c845fad8d46)

2ì‹œê°„ ì „ì— ì˜¬ë¦° ìƒí’ˆì´ 22ì‹œê°„ ì „ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ëŠ” í˜„ìƒì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. ì²˜ìŒì—ëŠ” ì‹œê°„ ì°¨ì´ë¥¼ ê³„ì‚°í•˜ëŠ” ë¡œì§ì´ ì˜ëª»ë˜ì—ˆë‹¤ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤.

![image](https://github.com/Gundy93/GundyMarket/assets/106914201/b1f9aaad-836a-4f50-8f5d-16fea5066b9d)

í•˜ì§€ë§Œ ì„œë²„ì˜ ì‘ë‹µìœ¼ë¡œ ì œê³µë˜ëŠ” ëª¨ë“  ë°ì´í„°ì˜ ì‹œê°„ ê°’ì´ "yyyy-MM-dd'T'00:00:00"ì˜ í˜•íƒœë¡œ ì œê³µë˜ëŠ” ê²ƒì´ì—ˆìŠµë‹ˆë‹¤.ê·¸ë˜ì„œ í•­ìƒ ìì •ê¹Œì§€ì˜ ì‹œê°„ì°¨ì´ë¥¼ ê³„ì‚°í•˜ê³  ìˆì—ˆìŠµë‹ˆë‹¤.

ëª¨ë°”ì¼ ìƒì—ì„œ ì—…ë¡œë“œ ëœ ì‹œê°„ì„ ì•Œì•„ë‚¼ ë°©ë²•ì´ ì—†ìœ¼ë¯€ë¡œ ì‹œê°„ ì´í•˜ì˜ ê°’ì€ ë³´ì—¬ì£¼ì§€ ì•ŠëŠ” ê²ƒìœ¼ë¡œ ì½”ë“œë¥¼ ë³€ê²½í–ˆìŠµë‹ˆë‹¤.

```swift
// ë³€ê²½ ì „

func string() -> String {
    if year > 0 {
        return String(year) + "ë…„"
    } else if month > 0 {
        return String(month) + "ë‹¬"
    } else if day > 0 {
        return String(day) + "ì¼"
    } else if hour > 0 {
        return String(hour) + "ì‹œê°„"
    } else if minute > 0 {
        return String(minute) + "ë¶„"
    } else {
        return String(second) + "ì´ˆ"
    }
}

// ë³€ê²½ í›„

func string() -> String {
    if year > 0 {
        return String(year) + "ë…„"
    } else if month > 0 {
        return String(month) + "ë‹¬"
    } else if day > 0 {
        return String(day) + "ì¼"
    } else {
        return "ë°©ê¸ˆ"
    }
}
```

![image](https://github.com/Gundy93/GundyMarket/assets/106914201/2e06d2a1-051d-483e-a499-2dc68dacfdc3)

[â¬†ï¸ ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°](#-ëª©ì°¨)

## ğŸ’­ ì´ìœ  ìˆëŠ” ì½”ë“œ

### ë¹„ìŠ·í•œ JSON ë°ì´í„°ì— ëŒ€ì‘í•˜ëŠ” DTO

|ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ Response|ìƒí’ˆ ìƒì„¸ ì¡°íšŒ Response|
|:--:|:--:
|![image](https://github.com/Gundy93/GundyMarket/assets/106914201/d63bd18a-36f8-4ac9-927c-d255eb7fde7a)|![image](https://github.com/Gundy93/GundyMarket/assets/106914201/54d9b419-e8ac-4917-8fd2-d14414731a08)|

ë‘ Responseì˜ ê°’ì€ ëŒ€ì²´ë¡œ ë¹„ìŠ·í•©ë‹ˆë‹¤. `images`ë¥¼ ì œì™¸í•˜ë©´ í° ì°¨ì´ê°€ ì—†ë‹¤ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë‘ ì¢…ë¥˜ì˜ Responseì— ëŒ€ì‘í•  ìˆ˜ ìˆë„ë¡ ì¤‘ë³µë˜ëŠ” í”„ë¡œí¼í‹°ë¥¼ ë¬¶ê³ , í•„ìš”í•œ í”„ë¡œí¼í‹°ë§Œ ë‚¨ê¸°ë„ë¡ í–ˆìŠµë‹ˆë‹¤. ë˜í•œ ìƒì„¸ ì¡°íšŒì—ë§Œ ì œê³µë˜ëŠ” `images`ì™€ `vendors`ëŠ” ì˜µì…”ë„ë¡œ ì„ ì–¸í•˜ëŠ” ê²ƒìœ¼ë¡œ í•˜ë‚˜ì˜ `DTO` íƒ€ì…ìœ¼ë¡œ ë‘ ì¡°íšŒ ëª¨ë‘ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.

```swift
struct ProductDTO: Decodable {
    let id: Int
    let name: String
    let description: String
    let thumbnailURL: String
    let currency: Currency
    let price: Int
    let createdAt: String
    let issuedAt: String
    let images: [ProductImage]?
    let vendor: Vendor?
    
    enum CodingKeys: String, CodingKey {
        case id, name, description, currency, images
        case thumbnailURL = "thumbnail"
        case price = "bargain_price"
        case createdAt = "created_at"
        case issuedAt = "issued_at"
        case vendor = "vendors"
    }
}
```

### NetworkManager

ë§¤ë‹ˆì €ë¼ëŠ” ì´ë¦„ì— ê±¸ë§ë„ë¡ ë²”ìš©ì ì¸ ë„¤íŠ¸ì›Œí¬ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ ë„¤íŠ¸ì›Œí¬ ë ˆì´ì–´ë¥¼ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤. ë˜í•œ íŠ¹ì • íƒ€ì…ì— ì˜ì¡´í•˜ì§€ ì•Šë„ë¡ í”„ë¡œí† ì½œì„ í†µí•´ ì¶”ìƒí™”í•˜ì—¬ DIPë¥¼ ì¤€ìˆ˜í•  ìˆ˜ ìˆë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.

`URLRequest`ë¥¼ ì ì ˆíˆ ë§Œë“¤ê³ , ì‘ë‹µì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ í•  ìˆ˜ ìˆëŠ” `NetworkBuilderProtocol`ì„ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬ë°›ì•„ ë„¤íŠ¸ì›Œí‚¹ì„ ì§„í–‰í•˜ëŠ” `NetworkSessionProtocol`ì„ í†µí•´ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.

```swift
final class NetworkManager {
    private let session: NetworkSessionProtocol
    
    init(session: NetworkSessionProtocol) {
        self.session = session
    }
    
    func request<Builder: NetworkBuilderProtocol>(
        _ builder: Builder,
        completion: @escaping (Result<Builder.Response, Error>) -> Void
    ) {
        ...
        session.dataTask(with: request) { result in
            ...
        }
        ...
    }
}

protocol NetworkSessionProtocol {
    func dataTask(
        with request: URLRequest,
        completion: @escaping (Result<Data, Error>) -> Void
    )
}

protocol NetworkBuilderProtocol {
    associatedtype Response: Decodable

    var baseURL: String { get }
    var path: String { get }
    var queryItems: [String : String] { get }
    var headers: [String : String] { get }
    var parameters: [String : Any] { get }
    var httpMethod: String { get }
    var serializer: NetworkSerializable? { get }
    var deserializer: NetworkDeserializable { get }
}
```

`NetworkBuilderProtocol`ê°€ `httpMethod`ë¥¼ í”„ë¡œí¼í‹°ë¡œ ê°–ë„ë¡ í•˜ì—¬ `NetworkManager`ì˜ `request` ë©”ì„œë“œ í•˜ë‚˜ë¡œ `GET`, `POST`, `PATCH`, `DELETE` ë“± ë‹¤ì–‘í•œ HTTPMethodë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•˜ì˜€ìŠµë‹ˆë‹¤.

ë˜í•œ `NetworkSessionProtocol`ì˜ ê²½ìš°ëŠ” í”„ë¡œí† ì½œë¡œ ì¶”ìƒí™”ë˜ì—ˆê¸° ë•Œë¬¸ì— ì¸í„°ë„· ì—°ê²°ì´ ë˜ì§€ ì•Šì€ ìƒí™©ì—ì„œë„ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” Test Doubleì„ ëª©í‘œë¡œ í•˜ì˜€ìŠµë‹ˆë‹¤. ë‹¨ìˆœíˆ ë§¤ê°œë³€ìˆ˜ë¥¼ ì±„ìš°ê¸° ìœ„í•œ `MockNetworkBuilder`ì™€ ì§€ì •ëœ ê°’ì„ ë°˜í™˜í•˜ëŠ” `StubNetworkSession`ì„ ë§Œë“¤ì–´ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

[â¬†ï¸ ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°](#-ëª©ì°¨)
